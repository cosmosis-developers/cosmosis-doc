

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sampler Features &mdash; CosmoSIS 3.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=26f62d79"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pipeline Features" href="pipeline_features.html" />
    <link rel="prev" title="Upgrading from the previous CosmoSIS Version" href="../usage/upgrading.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CosmoSIS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/overview.html">CosmoSIS Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/installation.html">Installing CosmoSIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using CosmoSIS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/tutorials.html">Tutorials: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/samplers.html">Samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/parameter_files.html">CosmoSIS Parameter Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/standard_library_overview.html">Standard Library Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/upgrading.html">Upgrading from the previous CosmoSIS Version</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bonus Features:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sampler Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#derived-parameters">Derived Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fast-slow-sampling">Fast / Slow Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resuming-sampling">Resuming Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampler-chaining">Sampler Chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-points">Starting points</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pipeline_features.html">Pipeline Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_features.html">Parameter Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="campaign.html">Managing sets of runs with a Campaign</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/api_python.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api_c.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api_cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api_f90.html">Fortran API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/cosmosis_command_line.html">Command line flags for cosmosis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cosmosis_campaign.html">cosmosis-campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cosmosis_configure.html">Command line flags for cosmosis-configure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cosmosis_extract.html">Command line flags for cosmosis-extract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cosmosis_sample_fisher.html">Command line flags for cosmosis-sample-fisher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/postprocess_command_line.html">Command line flags for postprocess</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/standard_library_complete.html">Standard Library Complete Listing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/nersc_examples.html">NERSC Submission Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help/faq.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CosmoSIS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Sampler Features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/features/sampler_features.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sampler-features">
<h1>Sampler Features<a class="headerlink" href="#sampler-features" title="Link to this heading"></a></h1>
<p>CosmoSIS has several features that can help you out in building and running pipelines</p>
<section id="derived-parameters">
<h2>Derived Parameters<a class="headerlink" href="#derived-parameters" title="Link to this heading"></a></h2>
<p>Often you want to sample in one parameter but plot results in a different, derived parameter.</p>
<p>In CosmoSIS, you add a listing of any parameters you want in the <code class="code docutils literal notranslate"><span class="pre">extra_output</span></code> parameter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline]</span>
<span class="na">extra_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">distances/age</span>
</pre></div>
</div>
<p>This will add a new output column, containing the value found in the <code class="code docutils literal notranslate"><span class="pre">age</span></code> value in the <code class="code docutils literal notranslate"><span class="pre">distances</span></code> section of the datablock.  If it is not found, <code class="code docutils literal notranslate"><span class="pre">NaN</span></code> will be shown.</p>
<p>If the value you want is a vector, then you need to find out first how long the vector is, and then specify that with a <code class="code docutils literal notranslate"><span class="pre">#</span></code> in the parameter, for example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline]</span>
<span class="na">extra_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">data_vector/2pt_theory</span><span class="c1">#457</span>
</pre></div>
</div>
</section>
<section id="fast-slow-sampling">
<h2>Fast / Slow Sampling<a class="headerlink" href="#fast-slow-sampling" title="Link to this heading"></a></h2>
<p>Some sampling methods can take advantage of a <em>speed hierarchy</em> in parameter spaces: in many models it is faster to re-calculate likelihoods if only certain (“fast”) parameters are changed, by caching calculations that use <em>only</em> the other “slow” parameters.</p>
<p>CosmoSIS implements this by splitting the pipeline into a slow part and a fast part.  You can tell it where to make that split, and it will do everything else for you, and report on the speed-up.</p>
<p>You can activate fast/slow sampling using these parameters:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline]</span>
<span class="c1">; This enables fast/slow sampling</span>
<span class="na">fast_slow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">T</span>

<span class="c1">; This selects the first fast module.  If it is not specified</span>
<span class="c1">; one will be chosen automatically</span>
<span class="na">first_fast_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">name_of_module</span>
</pre></div>
</div>
<p>The Fisher, Grid, Metropolis, Multinest, Polychord, and Star samplers can take advantage of fast/slow sampling.</p>
</section>
<section id="resuming-sampling">
<h2>Resuming Sampling<a class="headerlink" href="#resuming-sampling" title="Link to this heading"></a></h2>
<p>Several samplers can resume sampling if they are interrupted for some reason.</p>
<p>The Zeus, Emcee, Multinest, Polychord, Nautilus, and Metropolis samplers can be told to resume like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[runtime]</span>
<span class="na">resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">T</span>
</pre></div>
</div>
<p>The Multinest and Polychord need to be told an output file root to enable this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[multinest]</span>
<span class="na">multinest_outfile_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">./directory_to_save_progress</span>

<span class="k">[polychord]</span>
<span class="na">polychord_outfile_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">./directory_to_save_progress</span>
</pre></div>
</div>
<p>If a sampler is interrupted then simply re-run the same command again to resume sampling.  If no old sampling information is found then the job will start afresh (so it is fine to put <code class="docutils literal notranslate"><span class="pre">resume=T</span></code> on the first run).</p>
</section>
<section id="sampler-chaining">
<h2>Sampler Chaining<a class="headerlink" href="#sampler-chaining" title="Link to this heading"></a></h2>
<p>You can specify a sequence of samplers in the <code class="docutils literal notranslate"><span class="pre">sampler</span></code> parameters in the <code class="docutils literal notranslate"><span class="pre">[runtime]</span></code> section to run one pipeline after the other; each imports a set of basic information from the previous one.  For example, you could do this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[runtime]</span>
<span class="na">sampler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">maxlike  fisher  emcee</span>
</pre></div>
</div>
<p>to:
- find the best-fitting point
- compute the fisher matrix approximation to the covariance at that point
- initialise emcee walkers from that covariance</p>
<p>Currently only a best-fit estimate and covariance estimate are passed to the next sampler; if you can think of more then please open an issue.</p>
</section>
<section id="starting-points">
<h2>Starting points<a class="headerlink" href="#starting-points" title="Link to this heading"></a></h2>
<p>Several samplers share a common set of parameters that are used to control the starting point of the algorithm.  They are:
- maxlike
- minuit
- zeus
- emcee
- fisher
- test</p>
<p>All these samplers can take the following parameters:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">start_method</span></code> takes one of the following values to determine how to start the chain</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">chain-sample</span></code> - choose a random sample from a previous chain file (weighted if the chain has weights)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain-maxpost</span></code> - choose the maximum-posterior point from a previous chain file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain-maxlike`</span></code> - choose the maximum-likelihood point from a previous chain file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain</span></code> - decide from the above three options based on the file contents and requirements (sample if multiple points are needed, otherwise maxpost if post column found, otherwise maxlike column if like column found, otherwise last)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain-last`</span></code> - choose the last point from a previous chain file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prior</span></code> - chooise a random point from the prior distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cov`</span></code> - load the specified covariance matrix and choose a random point from the multivariate Gaussian defined by it</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">start_input</span></code>: for the choices of <cite>start_method</cite> the begin from an input file, this is the name of the file to read.</p></li>
</ul>
<p>All of these methods are superseded if using sampler chaining (see above) and the previous sampler has recorded a best-fitting point.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../usage/upgrading.html" class="btn btn-neutral float-left" title="Upgrading from the previous CosmoSIS Version" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline_features.html" class="btn btn-neutral float-right" title="Pipeline Features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, The CosmoSIS Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>