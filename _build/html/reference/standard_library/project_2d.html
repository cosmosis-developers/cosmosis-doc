

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>project_2d &mdash; CosmoSIS 3.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=26f62d79"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="qso" href="qso.html" />
    <link rel="prev" title="planck_sz" href="planck_sz.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CosmoSIS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro/overview.html">CosmoSIS Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/installation.html">Installing CosmoSIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using CosmoSIS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/tutorials.html">Tutorials: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/samplers.html">Samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/parameter_files.html">CosmoSIS Parameter Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/standard_library_overview.html">Standard Library Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/upgrading.html">Upgrading from the previous CosmoSIS Version</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bonus Features:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../features/sampler_features.html">Sampler Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/pipeline_features.html">Pipeline Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/parameter_features.html">Parameter Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/campaign.html">Managing sets of runs with a Campaign</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/api_python.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api_c.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api_cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api_f90.html">Fortran API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cosmosis_command_line.html">Command line flags for cosmosis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cosmosis_campaign.html">cosmosis-campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cosmosis_configure.html">Command line flags for cosmosis-configure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cosmosis_extract.html">Command line flags for cosmosis-extract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cosmosis_sample_fisher.html">Command line flags for cosmosis-sample-fisher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocess_command_line.html">Command line flags for postprocess</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../standard_library_complete.html">Standard Library Complete Listing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2pt.html">2pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="6dFGS.html">6dFGS</a></li>
<li class="toctree-l2"><a class="reference internal" href="BBN.html">BBN</a></li>
<li class="toctree-l2"><a class="reference internal" href="BBN-Consistency.html">BBN-Consistency</a></li>
<li class="toctree-l2"><a class="reference internal" href="BICEP2.html">BICEP2</a></li>
<li class="toctree-l2"><a class="reference internal" href="BOSS.html">BOSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="CRL_Eisenstein_Hu.html">CRL_Eisenstein_Hu</a></li>
<li class="toctree-l2"><a class="reference internal" href="Cluster_mass.html">Cluster_mass</a></li>
<li class="toctree-l2"><a class="reference internal" href="CosmicEmu.html">CosmicEmu</a></li>
<li class="toctree-l2"><a class="reference internal" href="EuclidEmulator2.html">EuclidEmulator2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Extreme_Value_Statistics.html">Extreme_Value_Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="FrankenEmu.html">FrankenEmu</a></li>
<li class="toctree-l2"><a class="reference internal" href="Joachimi_Bridle_alpha.html">Joachimi_Bridle_alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="JulloLikelihood.html">JulloLikelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="NLfactor.html">NLfactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="Press_Schechter_MF.html">Press_Schechter_MF</a></li>
<li class="toctree-l2"><a class="reference internal" href="Riess11.html">Riess11</a></li>
<li class="toctree-l2"><a class="reference internal" href="Riess16.html">Riess16</a></li>
<li class="toctree-l2"><a class="reference internal" href="Riess21.html">Riess21</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sheth-Tormen%20MF.html">Sheth-Tormen MF</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tinker_MF.html">Tinker_MF</a></li>
<li class="toctree-l2"><a class="reference internal" href="WiggleZBao.html">WiggleZBao</a></li>
<li class="toctree-l2"><a class="reference internal" href="act-dr6-lens.html">act-dr6-lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_intrinsic.html">add_intrinsic</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_magnification.html">add_magnification</a></li>
<li class="toctree-l2"><a class="reference internal" href="apply_astrophysical_biases.html">apply_astrophysical_biases</a></li>
<li class="toctree-l2"><a class="reference internal" href="astropy_background.html">astropy_background</a></li>
<li class="toctree-l2"><a class="reference internal" href="bacco_emulator.html">bacco_emulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="balmes.html">balmes</a></li>
<li class="toctree-l2"><a class="reference internal" href="baryonic.html">baryonic</a></li>
<li class="toctree-l2"><a class="reference internal" href="boss_dr12.html">boss_dr12</a></li>
<li class="toctree-l2"><a class="reference internal" href="boss_dr12_lrg_reanalyze.html">boss_dr12_lrg_reanalyze</a></li>
<li class="toctree-l2"><a class="reference internal" href="camb.html">camb</a></li>
<li class="toctree-l2"><a class="reference internal" href="cl_to_corr.html">cl_to_corr</a></li>
<li class="toctree-l2"><a class="reference internal" href="cl_to_xi_nicaea.html">cl_to_xi_nicaea</a></li>
<li class="toctree-l2"><a class="reference internal" href="cl_to_xi_wigner_d.html">cl_to_xi_wigner_d</a></li>
<li class="toctree-l2"><a class="reference internal" href="class.html">class</a></li>
<li class="toctree-l2"><a class="reference internal" href="clerkin.html">clerkin</a></li>
<li class="toctree-l2"><a class="reference internal" href="consistency.html">consistency</a></li>
<li class="toctree-l2"><a class="reference internal" href="constant_bias.html">constant_bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="copy.html">copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlated_priors.html">correlated_priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosebis.html">cosebis</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete.html">delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="des-y3-bao.html">des-y3-bao</a></li>
<li class="toctree-l2"><a class="reference internal" href="desi_dr1_arxiv.html">desi_dr1_arxiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="distances.html">distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="eboss_dr14_lya.html">eboss_dr14_lya</a></li>
<li class="toctree-l2"><a class="reference internal" href="eboss_dr16_elg.html">eboss_dr16_elg</a></li>
<li class="toctree-l2"><a class="reference internal" href="eboss_dr16_lrg.html">eboss_dr16_lrg</a></li>
<li class="toctree-l2"><a class="reference internal" href="eboss_dr16_lya.html">eboss_dr16_lya</a></li>
<li class="toctree-l2"><a class="reference internal" href="eboss_dr16_qso.html">eboss_dr16_qso</a></li>
<li class="toctree-l2"><a class="reference internal" href="extract_growth.html">extract_growth</a></li>
<li class="toctree-l2"><a class="reference internal" href="extrapolate.html">extrapolate</a></li>
<li class="toctree-l2"><a class="reference internal" href="fast_pt.html">fast_pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="fgas.html">fgas</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaussian_window.html">gaussian_window</a></li>
<li class="toctree-l2"><a class="reference internal" href="growth_factor.html">growth_factor</a></li>
<li class="toctree-l2"><a class="reference internal" href="h0licow.html">h0licow</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsc_cosmic_shear.html">hsc_cosmic_shear</a></li>
<li class="toctree-l2"><a class="reference internal" href="ia_z_powerlap.html">ia_z_powerlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="ia_z_powerlaw.html">ia_z_powerlaw</a></li>
<li class="toctree-l2"><a class="reference internal" href="isitgr-camb.html">isitgr-camb</a></li>
<li class="toctree-l2"><a class="reference internal" href="jla.html">jla</a></li>
<li class="toctree-l2"><a class="reference internal" href="kappa_beam.html">kappa_beam</a></li>
<li class="toctree-l2"><a class="reference internal" href="kappa_ell_cut.html">kappa_ell_cut</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_alignments.html">linear_alignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_nz.html">load_nz</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_nz_fits.html">load_nz_fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="log_w_model.html">log_w_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="lrg.html">lrg</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgcamb.html">mgcamb</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgs.html">mgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgs_bao.html">mgs_bao</a></li>
<li class="toctree-l2"><a class="reference internal" href="no_bias.html">no_bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="nz_multirank.html">nz_multirank</a></li>
<li class="toctree-l2"><a class="reference internal" href="pantheon.html">pantheon</a></li>
<li class="toctree-l2"><a class="reference internal" href="pantheon_plus.html">pantheon_plus</a></li>
<li class="toctree-l2"><a class="reference internal" href="photoz_bias.html">photoz_bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="planck2018.html">planck2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="planck_py.html">planck_py</a></li>
<li class="toctree-l2"><a class="reference internal" href="planck_sz.html">planck_sz</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">project_2d</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-parameters">Setup Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-values">Input values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-values">Output values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qso.html">qso</a></li>
<li class="toctree-l2"><a class="reference internal" href="rename.html">rename</a></li>
<li class="toctree-l2"><a class="reference internal" href="rescale_distances_rdh.html">rescale_distances_rdh</a></li>
<li class="toctree-l2"><a class="reference internal" href="sacc_like.html">sacc_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="shear_bias.html">shear_bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="sigma8_rescale.html">sigma8_rescale</a></li>
<li class="toctree-l2"><a class="reference internal" href="sigma_cpp.html">sigma_cpp</a></li>
<li class="toctree-l2"><a class="reference internal" href="sigma_r.html">sigma_r</a></li>
<li class="toctree-l2"><a class="reference internal" href="smail.html">smail</a></li>
<li class="toctree-l2"><a class="reference internal" href="stop.html">stop</a></li>
<li class="toctree-l2"><a class="reference internal" href="strong_lens_time_delays.html">strong_lens_time_delays</a></li>
<li class="toctree-l2"><a class="reference internal" href="tdcosmo.html">tdcosmo</a></li>
<li class="toctree-l2"><a class="reference internal" href="w0wa_sum_prior.html">w0wa_sum_prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="wl_spectra.html">wl_spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="wl_spectra_ppf.html">wl_spectra_ppf</a></li>
<li class="toctree-l2"><a class="reference internal" href="wmap.html">wmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="wmap_shift.html">wmap_shift</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nersc_examples.html">NERSC Submission Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help/faq.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CosmoSIS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../standard_library_complete.html">Standard Library Complete Listing</a></li>
      <li class="breadcrumb-item active">project_2d</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/reference/standard_library/project_2d.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="project-2d">
<h1>project_2d<a class="headerlink" href="#project-2d" title="Link to this heading"></a></h1>
<p>Project 3D power spectra to 2D tomographic bins using the Limber approximation</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>File</p></td>
<td><p>structure/projection/project_2d.py</p></td>
</tr>
<tr class="row-even"><td><p>Attribution</p></td>
<td><p>CosmoSIS Team</p></td>
</tr>
<tr class="row-odd"><td><p>URL</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>The Limber approximation integrates a 3D power spectrum over the radial
direction to get a 2D angular power spectrum.  It is an approximation
which is only valid on smaller scales.</p>
<p><span class="math notranslate nohighlight">\(C_\ell =  A \int_0^{\chi_1} W_1(\chi) W_2(\chi) P(k=(l+0.5)/\chi, z(\chi)) / \chi^2 d\chi\)</span></p>
<p>The full integral must integrate over k(ell) also.
This module is a python interface to a Limber integrator written in C, and can
generate a range of different spectra depending on what options you set.</p>
<p>It can generate spectra for any pair of
(Shear, Position, Intrinsic, Magnification, Cmbkappa)
though beware that for certain combinations and scales the Limber approximation will
be inaccurate.</p>
<p>Depending which spectra you ask for, it will look for different input P(k) value:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option name</p></th>
<th class="head"><p>Input-3d-spectrum</p></th>
<th class="head"><p>Default output name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>shear-shear</p></td>
<td><p>matter_power_nl</p></td>
<td><p>shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>weyl-weyl</p></td>
<td><p>weyl_curvature_spectrum_nl</p></td>
<td><p>shear_cl</p></td>
</tr>
<tr class="row-even"><td><p>shear-intrinsic</p></td>
<td><p>matter_intrinsic_power</p></td>
<td><p>shear_cl_gi</p></td>
</tr>
<tr class="row-odd"><td><p>intrinsic-intrinsic</p></td>
<td><p>intrinsic_power</p></td>
<td><p>shear_cl_ii</p></td>
</tr>
<tr class="row-even"><td><p>intrinsicb-intrinsicb</p></td>
<td><p>intrinsic_power_bb</p></td>
<td><p>shear_cl_bb</p></td>
</tr>
<tr class="row-odd"><td><p>position-position</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_cl</p></td>
</tr>
<tr class="row-even"><td><p>magnification-density</p></td>
<td><p>matter_power_nl</p></td>
<td><p>magnification_density_cl</p></td>
</tr>
<tr class="row-odd"><td><p>magnification-magnification</p></td>
<td><p>matter_power_nl</p></td>
<td><p>magnification_cl</p></td>
</tr>
<tr class="row-even"><td><p>position-shear</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>density-intrinsic</p></td>
<td><p>matter_intrinsic_power</p></td>
<td><p>galaxy_intrinsic_cl</p></td>
</tr>
<tr class="row-even"><td><p>magnification-intrinsic</p></td>
<td><p>matter_intrinsic_power</p></td>
<td><p>magnification_intrinsic_cl</p></td>
</tr>
<tr class="row-odd"><td><p>magnification-shear</p></td>
<td><p>matter_power_nl</p></td>
<td><p>magnification_shear_cl</p></td>
</tr>
<tr class="row-even"><td><p>shear-cmbkappa</p></td>
<td><p>matter_power_nl</p></td>
<td><p>shear_cmbkappa_cl</p></td>
</tr>
<tr class="row-odd"><td><p>cmbkappa-cmbkappa</p></td>
<td><p>matter_power_nl</p></td>
<td><p>cmbkappa_cl</p></td>
</tr>
<tr class="row-even"><td><p>intrinsic-cmbkappa</p></td>
<td><p>matter_intrinsic_power</p></td>
<td><p>intrinsic_cmbkappa_cl</p></td>
</tr>
<tr class="row-odd"><td><p>density-cmbkappa</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_cmbkappa_cl</p></td>
</tr>
<tr class="row-even"><td><p>fast-shear-shear-ia</p></td>
<td><p>matter_power_nl</p></td>
<td><p>shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>fast-lingal-shear-ia</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_shear_cl</p></td>
</tr>
<tr class="row-even"><td><p>fast-position-shear-ia</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>lingal-lingal</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_cl</p></td>
</tr>
<tr class="row-even"><td><p>lingal-shear</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>lingal-magnification</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_magnification_cl</p></td>
</tr>
<tr class="row-even"><td><p>lingal-intrinsic</p></td>
<td><p>matter_intrinsic_power</p></td>
<td><p>galaxy_intrinsic_cl</p></td>
</tr>
<tr class="row-odd"><td><p>nlgal-nlgal</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_cl</p></td>
</tr>
<tr class="row-even"><td><p>nlgal-shear</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_shear_cl</p></td>
</tr>
<tr class="row-odd"><td><p>nlgal-magnification</p></td>
<td><p>matter_power_nl</p></td>
<td><p>galaxy_magnification_cl</p></td>
</tr>
</tbody>
</table>
<p>For each of the spectra listed above you can set a parameter in the parameter file
to describe whether that term should be calculated and what input n(z) and output
names should be used for it.</p>
<p>You can set either:</p>
<p>shear-shear = T   ; to use the default wl_number_density n(z) section and save to default shear_cl</p>
<p>shear-shear = euclid-ska  ; to cross-correlate n(z) from nz_euclid and nz_ska sections, and save to shear_cl</p>
<p>shear-shear = red-red:shear_cl_red  ; to auto-correlate n(z) from the nz_red section and then save to shear_cl_red</p>
<p>If no spectra are chosen at all then only “shear-shear=T” is assumed.</p>
<p>The same forms can be used for all the other spectra, though note that the magnification spectra
also require information on the luminosity function.</p>
<p>Lingal refers to clustering spectra for a linearly-biased sample. Nlgal is for non-linearly biased samples.</p>
<p>Parts of this code and the underlying implementation of limber are based on cosmocalc:
<a class="reference external" href="https://bitbucket.org/beckermr/cosmocalc-public">https://bitbucket.org/beckermr/cosmocalc-public</a></p>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>The Limber approximation is reasonable for the fields being integrated</p></li>
<li><p>Flat sky approximation</p></li>
<li><p>GR is assumed in various ways</p></li>
</ul>
</div></blockquote>
</section>
<section id="setup-parameters">
<h2>Setup Parameters<a class="headerlink" href="#setup-parameters" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>verbose</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Print more output.</p></td>
</tr>
<tr class="row-odd"><td><p>fatal_errors</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Raise an error instead of returning non-zero on error loading splines. Handy for debugging.</p></td>
</tr>
<tr class="row-even"><td><p>save_kernels</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Save the kernels n(chi) and w(chi) to the block</p></td>
</tr>
<tr class="row-odd"><td><p>do_exact</p></td>
<td><p>str</p></td>
<td></td>
<td><p>Spectra for which to do exact (non-limber) calculation at low ell (space-separated)</p></td>
</tr>
<tr class="row-even"><td><p>auto_only</p></td>
<td><p>str</p></td>
<td></td>
<td><p>Spectra for which to only compute auto-correlations, not inter-bin correlations (space-separated)</p></td>
</tr>
<tr class="row-odd"><td><p>clip_chi_kernels</p></td>
<td><p>float</p></td>
<td><p>1e-06</p></td>
<td><p>Fraction of the integration kernel peaks below which to set the kernel to zero</p></td>
</tr>
<tr class="row-even"><td><p>sig_over_dchi</p></td>
<td><p>float</p></td>
<td><p>50.0</p></td>
<td><p>Ratio of the kernel width to sampling. Sets the sampling of the kernels. Larger is more precise.</p></td>
</tr>
<tr class="row-odd"><td><p>shear_kernel_dchi</p></td>
<td><p>float</p></td>
<td><p>5.0</p></td>
<td><p>Sample spacing for shear kernels</p></td>
</tr>
<tr class="row-even"><td><p>limber_ell_start</p></td>
<td><p>int</p></td>
<td><p>300</p></td>
<td><p>For spectra listed in do_exact, the minimum ell to switch to Limber</p></td>
</tr>
<tr class="row-odd"><td><p>ell_min_logspaced</p></td>
<td><p>real</p></td>
<td><p>-1</p></td>
<td><p>Minimum ell value for log-spaced values (usually higher than linear)</p></td>
</tr>
<tr class="row-even"><td><p>ell_max_logspaced</p></td>
<td><p>real</p></td>
<td><p>-1</p></td>
<td><p>Maximum ell value for log-spaced values (usually higher than linear)</p></td>
</tr>
<tr class="row-odd"><td><p>n_ell_logspaced</p></td>
<td><p>real</p></td>
<td><p>-1</p></td>
<td><p>Number of log-spaced C_ell values produced</p></td>
</tr>
<tr class="row-even"><td><p>ell_min_linspaced</p></td>
<td><p>real</p></td>
<td><p>-1</p></td>
<td><p>Minimum ell value for linearly-spaced values (usually lower than log-spaced)</p></td>
</tr>
<tr class="row-odd"><td><p>ell_max_linspaced</p></td>
<td><p>real</p></td>
<td><p>-1</p></td>
<td><p>Maximum ell value for linearly-spaced values (usually higher than log-spaced)</p></td>
</tr>
<tr class="row-even"><td><p>n_ell_linspaced</p></td>
<td><p>real</p></td>
<td></td>
<td><p>Number of linearly-spaced C_ell values produced</p></td>
</tr>
<tr class="row-odd"><td><p>dlogchi</p></td>
<td><p>int</p></td>
<td><p>-1</p></td>
<td><p>spacing in log-chi for exact non-limber calculation (or -1 to auto-set)</p></td>
</tr>
<tr class="row-even"><td><p>chi_pad_upper</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Lower padding fraction in chi for non-limber calculation</p></td>
</tr>
<tr class="row-odd"><td><p>shear-shear</p></td>
<td><p>str or bool</p></td>
<td></td>
<td><p>See note in the explanation above for this and related parameters</p></td>
</tr>
<tr class="row-even"><td><p>limber_abs_tol</p></td>
<td><p>real</p></td>
<td><p>0.0</p></td>
<td><p>Absolute tolerance for the Limber integral</p></td>
</tr>
<tr class="row-odd"><td><p>limber_rel_tol</p></td>
<td><p>real</p></td>
<td><p>0.001</p></td>
<td><p>Relative tolerance for the Limber integral</p></td>
</tr>
<tr class="row-even"><td><p>lin_bias_prefix</p></td>
<td><p>str</p></td>
<td><p>b</p></td>
<td><p>Parameter name to use for linear bias values, e.g. b for b1, b2, b3, etc.</p></td>
</tr>
<tr class="row-odd"><td><p>do_rsd</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Whether to compute RSD in non-limber calculations</p></td>
</tr>
</tbody>
</table>
</section>
<section id="input-values">
<h2>Input values<a class="headerlink" href="#input-values" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Section</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>matter_power_nl</p></td>
<td><p>k_h</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Sample values of nonlinear spectrum in Mpc/h. Many inputs P(k) sections may be required depending on what C_ell spectra are requested - see above.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>z</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Redshift of nonlinear spectrum samples</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>P_k</p></td>
<td><p>real 2d</p></td>
<td></td>
<td><p>Nonlinear spectrum in (Mpc/h)^{-3}</p></td>
</tr>
<tr class="row-odd"><td><p>distances</p></td>
<td><p>z</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Redshift samples of d_m</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>a</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Scale factor samples of d_m</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>d_m</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Comoving distance to sample points.</p></td>
</tr>
<tr class="row-even"><td><p>cosmological_parameters</p></td>
<td><p>h0</p></td>
<td><p>real</p></td>
<td></td>
<td><p>The Hubble parameter H0/100 km/s/Mpc</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>chi_star</p></td>
<td><p>real</p></td>
<td></td>
<td><p>CMB distance. Only needed if doing CMB Kappa spectra.</p></td>
</tr>
<tr class="row-even"><td><p>wl_number_density</p></td>
<td><p>z</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Redshift samples of binned n(z). A different section name to wl_number_density will be used depending on the options chosen (see above)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>nbin</p></td>
<td><p>int</p></td>
<td></td>
<td><p>Number of tomographic bins used</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>bin_{i}</p></td>
<td><p>real 1d</p></td>
<td></td>
<td><p>Number density n(z) samples for each bin i=1..nbin.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="output-values">
<h2>Output values<a class="headerlink" href="#output-values" title="Link to this heading"></a></h2>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Output values</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Section</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>kernel_{sample}</p></td>
<td><p>n_of_chi_chi_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The chi values for the n(chi) calculation. Only if save_kernels=T.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>n_of_chi_n_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The n values for the n(chi) calculation. Only if save_kernels=T.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>w_of_chi_chi_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The chi values for the w(chi) calculation. Only if save_kernels=T and shear spectrum calculated.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>w_of_chi_n_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The n values for the w(chi) calculation. Only if save_kernels=T and shear spectrum calculated.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>ww_of_chi_chi_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The chi values for the ww(chi) calculation. Only if save_kernels=T and Weyl spectrum calculated.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>ww_of_chi_n_{i}</p></td>
<td><p>real 1d</p></td>
<td><p>The n values for the ww(chi) calculation. Only if save_kernels=T and Weyl spectrum calculated.</p></td>
</tr>
<tr class="row-even"><td><p>shear_cl</p></td>
<td><p>nbin_a</p></td>
<td><p>int</p></td>
<td><p>Number of tomographic bins for first of the two quantities correlated. Various sections will have these outputs depending on the options chosen</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>nbin_b</p></td>
<td><p>int</p></td>
<td><p>Number of tomographic bins for second of the two quantities correlated</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>nbin</p></td>
<td><p>int</p></td>
<td><p>Only if auto-correlation is calculated. Number of tomographic bins for the quantity (nbin=nbin_a=nbin_b)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>ell</p></td>
<td><p>int 1d</p></td>
<td><p>Values at which c_ell are calculated</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>bin_{i}_{j}</p></td>
<td><p>real 1d</p></td>
<td><p>S for relevant i and j combinations. C_ell calculated at corresponding ell.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>chi_peak_{i}_{j}</p></td>
<td><p>real</p></td>
<td><p>Only if get_kernel_peaks=T. Peak of the n(z) or w(z) for this bin combination</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>arcmin_per_Mpch_{i}_{j}</p></td>
<td><p>real</p></td>
<td><p>Only if get_kernel_peaks=T. Conversion factor from mpc/h to arcmin for this bin</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="planck_sz.html" class="btn btn-neutral float-left" title="planck_sz" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qso.html" class="btn btn-neutral float-right" title="qso" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, The CosmoSIS Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>